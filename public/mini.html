<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LightStock - Mini</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 15px;
      background: #f9f9f9;
      color: #333;
    }
    .nav {
      display: flex;
      border-bottom: 1px solid #ddd;
      margin-bottom: 20px;
    }
    .tab {
      padding: 10px 20px;
      background: #eee;
      border: 1px solid #ddd;
      border-bottom: none;
      border-radius: 5px 5px 0 0;
      margin-right: 5px;
      cursor: pointer;
    }
    .tab.active {
      background: white;
      font-weight: bold;
      border-bottom: 1px solid white;
      margin-bottom: -1px;
    }
    .content {
      display: none;
      background: white;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .content.active {
      display: block;
    }
    .search-input {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .fav-btn {
      background: none;
      border: none;
      font-size: 24px;
      color: #ccc;
      cursor: pointer;
      margin-left: 10px;
    }
    .fav-btn.active {
      color: gold;
    }
    .stock-info {
      margin-top: 20px;
    }
    .stock-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .positive { color: green; }
    .negative { color: red; }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    th {
      background: #f5f5f5;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>LightStock</h1>
  <p>Get stock information with minimal data usage</p>
  
  <div class="nav">
    <div class="tab active" onclick="showTab('search-tab')">Search</div>
    <div class="tab" onclick="showTab('favorites-tab')">Favorites</div>
  </div>
  
  <div id="search-tab" class="content active">
    <input type="text" class="search-input" placeholder="Enter stock symbol or name" id="stock-search">
    
    <div class="stock-info" id="stock-display" style="display:none;">
      <div class="stock-header">
        <h2 id="stock-name">Apple Inc. (AAPL)</h2>
        <button class="fav-btn" id="fav-btn" onclick="toggleFavorite()">â˜…</button>
      </div>
      <p><strong>Price:</strong> <span id="stock-price">$182.33</span></p>
      <p><strong>Change:</strong> <span id="stock-change" class="negative">-0.85 (-0.46%)</span></p>
      <p><strong>Day Range:</strong> <span id="stock-range">$180.44 - $183.69</span></p>
      <p><small id="stock-updated">Updated: May 10, 2025, 4:00PM</small></p>
    </div>
  </div>
  
  <div id="favorites-tab" class="content">
    <table>
      <thead>
        <tr>
          <th onclick="sortFavorites('name')">Name</th>
          <th onclick="sortFavorites('price')">Price (%)</th>
          <th onclick="sortFavorites('range')">Day Range</th>
        </tr>
      </thead>
      <tbody id="favorites-table">
        <!-- Favorites will be listed here -->
      </tbody>
    </table>
    <p id="empty-favorites" style="text-align:center; padding:20px;">No favorites added yet.</p>
  </div>
  
  <script>
    // Sample data
    const sampleStocks = {
      'AAPL': {
        name: 'Apple Inc.',
        symbol: 'AAPL',
        price: 182.33,
        change: -0.85,
        changePercent: -0.46,
        dayLow: 180.44,
        dayHigh: 183.69,
        updated: 'May 10, 2025, 4:00PM'
      },
      'MSFT': {
        name: 'Microsoft Corp.',
        symbol: 'MSFT',
        price: 415.56,
        change: 2.74,
        changePercent: 0.66,
        dayLow: 412.03,
        dayHigh: 416.78,
        updated: 'May 10, 2025, 4:00PM'
      },
      'GOOGL': {
        name: 'Alphabet Inc.',
        symbol: 'GOOGL',
        price: 170.35,
        change: 0.78,
        changePercent: 0.46,
        dayLow: 168.72,
        dayHigh: 171.19,
        updated: 'May 10, 2025, 4:00PM'
      },
      'TSLA': {
        name: 'Tesla Inc.',
        symbol: 'TSLA',
        price: 175.33,
        change: -3.28,
        changePercent: -1.83,
        dayLow: 174.01,
        dayHigh: 179.45,
        updated: 'May 10, 2025, 4:00PM'
      }
    };
    
    // DOM elements
    const stockSearch = document.getElementById('stock-search');
    const stockDisplay = document.getElementById('stock-display');
    const stockName = document.getElementById('stock-name');
    const stockPrice = document.getElementById('stock-price');
    const stockChange = document.getElementById('stock-change');
    const stockRange = document.getElementById('stock-range');
    const stockUpdated = document.getElementById('stock-updated');
    const favBtn = document.getElementById('fav-btn');
    const favoritesTable = document.getElementById('favorites-table');
    const emptyFavorites = document.getElementById('empty-favorites');
    
    // State
    let currentStock = null;
    let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
    let sortField = 'name';
    let sortDirection = 'asc';
    
    // Initialize
    renderFavorites();
    
    // Event listener for search
    stockSearch.addEventListener('keydown', function(e) {
      if (e.key === 'Enter') {
        const symbol = this.value.trim().toUpperCase();
        if (sampleStocks[symbol]) {
          displayStock(sampleStocks[symbol]);
        } else {
          // Try to find by name
          const stock = Object.values(sampleStocks).find(
            s => s.name.toLowerCase().includes(this.value.toLowerCase())
          );
          if (stock) {
            displayStock(stock);
          } else {
            alert('Stock not found. Try AAPL, MSFT, GOOGL, or TSLA.');
          }
        }
      }
    });
    
    // Functions
    function showTab(tabId) {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
      
      document.querySelector(`.tab[onclick="showTab('${tabId}')"]`).classList.add('active');
      document.getElementById(tabId).classList.add('active');
      
      if (tabId === 'favorites-tab') {
        renderFavorites();
      }
    }
    
    function displayStock(stock) {
      currentStock = stock;
      
      stockName.textContent = `${stock.name} (${stock.symbol})`;
      stockPrice.textContent = `$${stock.price.toFixed(2)}`;
      
      const changeText = `${stock.change >= 0 ? '+' : ''}${stock.change.toFixed(2)} (${stock.changePercent >= 0 ? '+' : ''}${stock.changePercent.toFixed(2)}%)`;
      stockChange.textContent = changeText;
      stockChange.className = stock.change >= 0 ? 'positive' : 'negative';
      
      stockRange.textContent = `$${stock.dayLow.toFixed(2)} - $${stock.dayHigh.toFixed(2)}`;
      stockUpdated.textContent = `Updated: ${stock.updated}`;
      
      // Update favorite button
      updateFavoriteButton();
      
      stockDisplay.style.display = 'block';
    }
    
    function toggleFavorite() {
      if (!currentStock) return;
      
      const index = favorites.findIndex(f => f.symbol === currentStock.symbol);
      
      if (index >= 0) {
        // Remove from favorites
        favorites.splice(index, 1);
      } else {
        // Add to favorites
        favorites.push(currentStock);
      }
      
      // Save to localStorage
      localStorage.setItem('favorites', JSON.stringify(favorites));
      
      // Update UI
      updateFavoriteButton();
      
      // If on favorites tab, update the table
      if (document.getElementById('favorites-tab').classList.contains('active')) {
        renderFavorites();
      }
    }
    
    function updateFavoriteButton() {
      if (!currentStock) return;
      
      const isFavorite = favorites.some(f => f.symbol === currentStock.symbol);
      favBtn.classList.toggle('active', isFavorite);
    }
    
    function renderFavorites() {
      favoritesTable.innerHTML = '';
      
      if (favorites.length === 0) {
        emptyFavorites.style.display = 'block';
        return;
      }
      
      emptyFavorites.style.display = 'none';
      
      // Sort favorites
      const sortedFavorites = [...favorites].sort((a, b) => {
        let valA, valB;
        
        switch (sortField) {
          case 'name':
            valA = a.name;
            valB = b.name;
            break;
          case 'price':
            valA = a.price;
            valB = b.price;
            break;
          case 'range':
            valA = a.dayHigh - a.dayLow;
            valB = b.dayHigh - b.dayLow;
            break;
          default:
            valA = a.name;
            valB = b.name;
        }
        
        if (typeof valA === 'string') {
          return sortDirection === 'asc' 
            ? valA.localeCompare(valB) 
            : valB.localeCompare(valA);
        } else {
          return sortDirection === 'asc' 
            ? valA - valB 
            : valB - valA;
        }
      });
      
      // Create table rows
      sortedFavorites.forEach(stock => {
        const row = document.createElement('tr');
        
        const nameCell = document.createElement('td');
        nameCell.textContent = `${stock.name} (${stock.symbol})`;
        nameCell.style.cursor = 'pointer';
        nameCell.onclick = () => {
          showTab('search-tab');
          displayStock(stock);
        };
        
        const priceCell = document.createElement('td');
        const priceText = `$${stock.price.toFixed(2)} (${stock.changePercent >= 0 ? '+' : ''}${stock.changePercent.toFixed(2)}%)`;
        priceCell.textContent = priceText;
        priceCell.className = stock.change >= 0 ? 'positive' : 'negative';
        
        const rangeCell = document.createElement('td');
        rangeCell.textContent = `$${stock.dayLow.toFixed(2)} - $${stock.dayHigh.toFixed(2)}`;
        
        row.appendChild(nameCell);
        row.appendChild(priceCell);
        row.appendChild(rangeCell);
        
        favoritesTable.appendChild(row);
      });
    }
    
    function sortFavorites(field) {
      if (sortField === field) {
        // Toggle direction
        sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
      } else {
        // New field, default to ascending
        sortField = field;
        sortDirection = 'asc';
      }
      
      renderFavorites();
    }
  </script>
</body>
</html>
